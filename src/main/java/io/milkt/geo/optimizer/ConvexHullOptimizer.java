package io.milkt.geo.optimizer;

import com.alibaba.fastjson.JSON;
import com.alibaba.fastjson.JSONArray;
import com.alibaba.fastjson.JSONObject;
import com.vividsolutions.jts.geom.Coordinate;
import com.vividsolutions.jts.geom.Geometry;
import com.vividsolutions.jts.io.WKTReader;
import java.util.ArrayList;
import java.util.List;

/**
 * 使用JTS的ConvexHull算法进行Polygon优化
 *
 * @author leewind (leewind19841209@gmail.com)
 * @version v0.1 2017.11.28
 */
public class ConvexHullOptimizer {

  public static void main(String[] args) throws Exception {

    String inputPoints = "{points :[[118.874184,32.031052],[118.873413,32.03072],[118.873413,32.030716],[118.871834,32.033333],[118.871689,32.033558],[118.871399,32.034058],[118.871078,32.034618],[118.870697,32.035286],[118.870567,32.0355],[118.870384,32.035828],[118.870277,32.036022],[118.870216,32.036133],[118.869041,32.0382],[118.868988,32.038246],[118.868874,32.038467],[118.868759,32.038601],[118.868744,32.038601],[118.868103,32.038273],[118.867523,32.03801],[118.86718,32.037876],[118.866859,32.037762],[118.866463,32.037621],[118.865585,32.037304],[118.865234,32.037155],[118.865232240741,32.0371541574074],[118.865196,32.037281],[118.865173,32.038097],[118.865173,32.038193],[118.865173,32.038429],[118.865135,32.038902],[118.865128,32.038994],[118.865067,32.039417],[118.865044,32.039665],[118.865028,32.039665],[118.86483,32.039665],[118.864578,32.039627],[118.864471,32.039631],[118.864334,32.039677],[118.863876,32.039948],[118.863602,32.040188],[118.863312,32.040474],[118.86319,32.040592],[118.863182,32.040596],[118.862984,32.040672],[118.862595,32.040802],[118.86171,32.041073],[118.860504,32.041454],[118.86039,32.041481],[118.860321,32.04147],[118.860313944941,32.0414680136241],[118.860397,32.041645],[118.861221,32.042824],[118.861275,32.042919],[118.861557,32.043442],[118.861633,32.043774],[118.861794,32.046875],[118.861794,32.048935],[118.861816,32.049931],[118.861801,32.050167],[118.861786,32.050549],[118.861977,32.050488],[118.864761,32.05014],[118.864761,32.050137],[118.864777,32.050213],[118.86483,32.050255],[118.864914,32.050259],[118.864975,32.050434],[118.865135,32.050907],[118.865349,32.051514],[118.86544,32.05175],[118.865555,32.052105],[118.865509,32.052197],[118.865501,32.052372],[118.865517,32.052479],[118.86554,32.052551],[118.865623,32.05265],[118.865692,32.052761],[118.865807,32.053654],[118.865837,32.053894],[118.865944,32.05434],[118.865997,32.054722],[118.866241,32.054703],[118.866585,32.054676],[118.866951,32.054661],[118.867035,32.054661],[118.86734,32.054657],[118.867638,32.054657],[118.867996,32.054657],[118.868362,32.054653],[118.868362,32.054649],[118.868561,32.055378],[118.868584,32.055779],[118.868568,32.05619],[118.868568,32.056637],[118.868561,32.056927],[118.868835,32.05724],[118.868935,32.05735],[118.869072,32.057472],[118.86911,32.057495],[118.869354,32.057499],[118.86953,32.057625],[118.869644,32.057655],[118.869713,32.057655],[118.87011,32.057652],[118.873184,32.060165],[118.873451,32.06023],[118.873695,32.060329],[118.87394,32.060471],[118.873993,32.060566],[118.874062,32.060646],[118.874146,32.060715],[118.874229,32.060768],[118.874435,32.060825],[118.874649,32.060825],[118.874809,32.060837],[118.874962,32.06089],[118.875092,32.060955],[118.875221,32.06105],[118.875412,32.061218],[118.875404,32.061275],[118.875282,32.062027],[118.875259,32.06226],[118.875252,32.062263],[118.874283,32.062733],[118.874161,32.062778],[118.874275,32.062737],[118.875249184239,32.0622683545628],[118.875069,32.062611],[118.875069,32.062653],[118.875061,32.062698],[118.875168,32.06295],[118.875168,32.06321],[118.87513,32.063328],[118.875008,32.063446],[118.874969,32.063622],[118.875008,32.063694],[118.875076,32.063763],[118.875114,32.063816],[118.875076,32.0639],[118.875069,32.06403],[118.875038,32.064556],[118.875008,32.064636],[118.87487,32.06472],[118.874702,32.064953],[118.874664,32.06498],[118.874596,32.064983],[118.874367,32.064968],[118.874207,32.065018],[118.874023,32.064995],[118.873428,32.065063],[118.87336,32.065121],[118.873161,32.065453],[118.873085,32.065708],[118.873024,32.065773],[118.873016,32.065777],[118.872925,32.065823],[118.872818,32.065838],[118.872704,32.065834],[118.872429,32.065739],[118.87233,32.065742],[118.872246,32.065777],[118.872223,32.065811],[118.872215,32.065914],[118.872223,32.066048],[118.872162,32.066132],[118.87207,32.066166],[118.872017,32.066177],[118.871948,32.066219],[118.871834,32.066391],[118.87178,32.066422],[118.871323,32.066376],[118.871292,32.066418],[118.871254,32.066494],[118.871246,32.066673],[118.87101,32.066872],[118.870506,32.066959],[118.870399,32.067005],[118.870285,32.067135],[118.870247,32.067162],[118.870201,32.067162],[118.870117,32.06715],[118.869652,32.067368],[118.869553,32.067448],[118.869553,32.067513],[118.869568,32.067566],[118.869553,32.067631],[118.869492,32.067684],[118.869217,32.067741],[118.869072,32.067783],[118.868835,32.067699],[118.868736,32.067711],[118.868683,32.06776],[118.86866,32.067818],[118.868576,32.068138],[118.868576,32.068218],[118.868523,32.068283],[118.86837,32.068375],[118.868263,32.068375],[118.868202,32.068386],[118.868103,32.068481],[118.86805,32.068493],[118.867737,32.068459],[118.867668,32.068554],[118.86763,32.068584],[118.867531,32.068604],[118.8675,32.068645],[118.86747,32.068825],[118.867493,32.068935],[118.867493,32.068993],[118.86747,32.069031],[118.867188,32.069046],[118.867104,32.069099],[118.866997,32.069294],[118.866966,32.069321],[118.866776,32.069283],[118.86673,32.069294],[118.866608,32.069439],[118.866188,32.069469],[118.866112,32.069515],[118.866081,32.069569],[118.866074,32.069721],[118.866051,32.069782],[118.865982,32.069832],[118.865829,32.069889],[118.865761,32.069874],[118.86541,32.069874],[118.865349,32.069916],[118.865242,32.070076],[118.865051,32.070023],[118.864944,32.070023],[118.864632,32.069927],[118.864479,32.069981],[118.864365,32.070049],[118.864105,32.070251],[118.864082,32.070312],[118.864052,32.070507],[118.864037,32.07058],[118.863937,32.070644],[118.863762,32.070648],[118.863708,32.070686],[118.863602,32.070812],[118.863594,32.070999],[118.863625,32.071064],[118.863632,32.071194],[118.863579,32.071224],[118.863541,32.071224],[118.863495,32.071213],[118.863312,32.070965],[118.863251,32.070923],[118.862923,32.070869],[118.862869,32.070877],[118.862732,32.071064],[118.862679,32.071064],[118.862434,32.071003],[118.862373,32.071003],[118.862328,32.071026],[118.862251,32.071194],[118.862198,32.071259],[118.862152,32.071281],[118.861938,32.071224],[118.861885,32.071259],[118.861885,32.071316],[118.862038,32.071499],[118.862091,32.071568],[118.862137,32.071884],[118.862137,32.071972],[118.862122,32.07206],[118.862068,32.072128],[118.862007,32.072193],[118.861832,32.072319],[118.861816,32.072327],[118.86203,32.072338],[118.862144,32.072289],[118.862267,32.072197],[118.862335,32.072128],[118.862411,32.07172],[118.862442,32.071701],[118.862488,32.071701],[118.86274,32.071972],[118.862915,32.072044],[118.862953,32.072094],[118.863029,32.072327],[118.863083,32.072411],[118.863182,32.072422],[118.863525,32.072361],[118.863686,32.072468],[118.863808,32.072865],[118.863914,32.073128],[118.863937,32.073292],[118.863922,32.073608],[118.863937,32.073841],[118.864166,32.074715],[118.864281,32.075096],[118.864311,32.07523],[118.864296,32.075344],[118.864204,32.075474],[118.863785,32.075859],[118.863754,32.076122],[118.863754,32.076706],[118.863792,32.0769],[118.863884,32.07708],[118.864037,32.077259],[118.864265,32.077396],[118.864571,32.077499],[118.864685,32.077499],[118.864799,32.077446],[118.865341,32.076847],[118.865494,32.07679],[118.865585,32.07679],[118.865959,32.077],[118.866508,32.077381],[118.866791,32.077648],[118.866959,32.07774],[118.867157,32.077789],[118.867775,32.077923],[118.867989,32.077999],[118.868118,32.078087],[118.8685,32.078579],[118.868546,32.078625],[118.870995,32.081135],[118.871902,32.080742],[118.87207,32.080677],[118.872498,32.080521],[118.873001,32.080212],[118.873283,32.080017],[118.874557,32.078938],[118.874855,32.078739],[118.875404,32.0783],[118.875404,32.078293],[118.875511,32.078407],[118.876106,32.078018],[118.876503,32.077732],[118.877876,32.076843],[118.877968,32.076778],[118.877968,32.076775],[118.878052,32.076862],[118.880035,32.075497],[118.880295,32.075314],[118.880783,32.075008],[118.881653,32.074432],[118.881851,32.074253],[118.882019,32.073978],[118.88237,32.073177],[118.882523,32.072926],[118.882881,32.072384],[118.883415,32.071606],[118.884056,32.070824],[118.884521,32.070202],[118.884727,32.069908],[118.884956,32.069508],[118.885139,32.06916],[118.885162,32.069096],[118.885361,32.068615],[118.885468,32.068264],[118.885757,32.067261],[118.886551,32.064911],[118.886925,32.063828],[118.887413,32.062477],[118.887413,32.062469],[118.888542,32.063023],[118.889587,32.063538],[118.889694,32.063595],[118.890923,32.064194],[118.892189,32.064835],[118.892372,32.064941],[118.892525,32.065063],[118.892647,32.065193],[118.89283,32.065407],[118.893509,32.066292],[118.893661,32.066528],[118.893921,32.066959],[118.894409,32.067883],[118.894447,32.067955],[118.89473,32.068504],[118.895775,32.070488],[118.896416,32.071697],[118.896469,32.071793],[118.896622,32.072071],[118.896744,32.072403],[118.896919,32.073009],[118.897034,32.073765],[118.896973,32.074577],[118.896919,32.074928],[118.896889,32.075039],[118.896561,32.075985],[118.896423,32.07634],[118.89621,32.076927],[118.895798,32.077789],[118.89563,32.078079],[118.895378,32.078476],[118.895065,32.078972],[118.894981,32.079067],[118.894913,32.079174],[118.894905,32.079174],[118.894646,32.079391],[118.894608,32.079441],[118.894249,32.079746],[118.894043,32.079926],[118.893867,32.080078],[118.893616,32.080265],[118.893242,32.080517],[118.892517,32.080959],[118.892242,32.081135],[118.891243,32.081745],[118.890762,32.082069],[118.890625,32.082161],[118.890526,32.082214],[118.890518,32.082218],[118.89061,32.082344],[118.890488,32.082474],[118.889763,32.082886],[118.889183,32.083157],[118.888664,32.083351],[118.888046,32.083549],[118.887695,32.083637],[118.88781,32.083984],[118.887939,32.084354],[118.887955,32.084393],[118.888054,32.084675],[118.888123,32.084881],[118.888184,32.085056],[118.888611,32.084969],[118.890648,32.084412],[118.891335,32.084183],[118.891335,32.084179],[118.891411,32.084377],[118.891411,32.084381],[118.891556,32.084339],[118.893341,32.083858],[118.893677,32.083801],[118.893929,32.08379],[118.894043,32.08379],[118.89422672973,32.0837788648649],[118.894043,32.083786],[118.893936,32.083786],[118.893677,32.083797],[118.893349,32.083855],[118.893341,32.083855],[118.893288,32.083702],[118.892586,32.081844],[118.892372,32.081272],[118.892372,32.081268],[118.892586,32.081142],[118.892776,32.081028],[118.8936,32.080528],[118.893837,32.080414],[118.894081,32.080318],[118.894318,32.080238],[118.894844,32.080109],[118.894928,32.080093],[118.894966,32.080078],[118.894997,32.080078],[118.895287,32.080029],[118.895393,32.080055],[118.895538,32.080078],[118.895546,32.080078],[118.896255,32.080235],[118.897224,32.080647],[118.897758,32.080902],[118.897964,32.08102],[118.898224,32.081146],[118.900177,32.082161],[118.901482,32.082817],[118.902184,32.083214],[118.903282,32.083885],[118.903625,32.084068],[118.903786,32.084145],[118.904091,32.084297],[118.904259,32.084381],[118.904854,32.084232],[118.904037,32.083858],[118.90403,32.083855],[118.904495,32.083263],[118.904816,32.082802],[118.904999,32.082561],[118.905548,32.081776],[118.905975,32.081161],[118.906593,32.080257],[118.90667,32.080132],[118.90715,32.079311],[118.907639,32.078388],[118.907784,32.078442],[118.907829,32.078468],[118.908188,32.078617],[118.908463,32.078724],[118.909157,32.079048],[118.909439,32.079182],[118.910568,32.079693],[118.909431,32.079174],[118.909157,32.079044],[118.908455,32.07872],[118.908188,32.078609],[118.907822,32.078461],[118.907776,32.078438],[118.907639,32.078381],[118.90773,32.078125],[118.908104,32.077393],[118.908203,32.077244],[118.908264,32.077164],[118.908379,32.077042],[118.908501,32.077023],[118.908539,32.077003],[118.908577,32.076977],[118.908646,32.076908],[118.908684,32.07679],[118.908684,32.076683],[118.908661,32.076645],[118.908615,32.076591],[118.908577,32.076557],[118.908524,32.076519],[118.908516,32.076515],[118.908516,32.076359],[118.908577,32.075077],[118.908592,32.074745],[118.908615,32.074406],[118.908638,32.074295],[118.908669,32.073582],[118.908714,32.072754],[118.908768,32.071503],[118.908791,32.070984],[118.908791,32.070976],[118.909058,32.071007],[118.909615,32.071068],[118.90976,32.071129],[118.909843,32.071205],[118.909904,32.071323],[118.910194,32.072075],[118.910332,32.072346],[118.910553,32.072948],[118.910576,32.073067],[118.910614,32.073177],[118.910637,32.073223],[118.91069,32.073261],[118.911385,32.073421],[118.911499,32.073486],[118.911575,32.073563],[118.911751,32.073666],[118.911819,32.073734],[118.911873,32.073814],[118.912148,32.074356],[118.912231,32.074486],[118.912453,32.075111],[118.912598,32.075317],[118.912811,32.075539],[118.912987,32.075668],[118.9133,32.075794],[118.913406,32.075939],[118.91346,32.076046],[118.913574,32.076561],[118.913582,32.076561],[118.915359,32.076271],[118.91568,32.076202],[118.916016,32.076145],[118.916107,32.076138],[118.916107,32.076134],[118.91671,32.075871],[118.916954,32.075748],[118.916992,32.075634],[118.916992,32.075535],[118.916672,32.074451],[118.916672,32.074448],[118.916107,32.072552],[118.915672,32.070904],[118.915428,32.070164],[118.91526,32.069782],[118.915146,32.069588],[118.915138,32.069481],[118.915138,32.069408],[118.915176,32.069355],[118.915337,32.069305],[118.915421,32.069317],[118.915497,32.069347],[118.915558,32.069359],[118.915726,32.069336],[118.915962,32.069244],[118.916199,32.069092],[118.916367,32.069054],[118.916435,32.069054],[118.916534,32.069088],[118.916908,32.069267],[118.917397,32.069458],[118.920547,32.068943],[118.920799,32.068897],[118.921616,32.068539],[118.921928,32.06842],[118.922119,32.06842],[118.922623,32.068497],[118.923126,32.068573],[118.923271,32.068577],[118.923347,32.06855],[118.92347,32.068459],[118.923553,32.068317],[118.923553,32.06831],[118.923798,32.066315],[118.923828,32.066067],[118.923882,32.065693],[118.92392,32.065159],[118.924011,32.064373],[118.924011,32.064365],[118.924973,32.064396],[118.925781,32.064495],[118.93,32.064625],[118.929993,32.063797],[118.929985,32.062775],[118.929955,32.061825],[118.929947,32.061646],[118.929909,32.060635],[118.929893,32.06031],[118.929863,32.059536],[118.929848,32.059208],[118.92984,32.058765],[118.929832,32.058758],[118.929825,32.058563],[118.92981,32.05798],[118.929802,32.057594],[118.929794,32.056881],[118.929794,32.056141],[118.92981,32.055653],[118.929855,32.055046],[118.929886,32.054874],[118.929947,32.054092],[118.929947,32.054089],[118.931206,32.05442],[118.931892,32.054573],[118.932106,32.054527],[118.932106,32.054523],[118.932091,32.054276],[118.931999,32.053219],[118.931923,32.052296],[118.931877,32.051888],[118.931877,32.051788],[118.931831,32.051323],[118.931793,32.051018],[118.931686,32.049927],[118.931679,32.049923],[118.931656,32.049553],[118.931648,32.049549],[118.931541,32.048771],[118.931511,32.048626],[118.931473,32.048332],[118.931442,32.048229],[118.931389,32.048126],[118.931313,32.048035],[118.93119,32.047905],[118.930855,32.047626],[118.929947,32.046909],[118.929939,32.046906],[118.929916,32.046749],[118.929878,32.046539],[118.929863,32.046375],[118.929878,32.045357],[118.929886,32.045048],[118.929886,32.045044],[118.928635,32.045086],[118.926025,32.045204],[118.925911,32.045212],[118.924034,32.045307],[118.923698,32.04533],[118.923218,32.045399],[118.923042,32.045425],[118.922119,32.045784],[118.922043,32.045818],[118.92086,32.046375],[118.920242,32.046745],[118.920235,32.046745],[118.920135,32.046684],[118.920082,32.046658],[118.919975,32.046593],[118.919868,32.046593],[118.919403,32.046825],[118.919113,32.04694],[118.91893,32.047012],[118.91877,32.047077],[118.917786,32.047512],[118.917572,32.04763],[118.917084,32.047039],[118.916695,32.046474],[118.916466,32.046146],[118.916092,32.045555],[118.915985,32.045399],[118.915558,32.044773],[118.91449,32.043243],[118.914215,32.042908],[118.914658,32.042603],[118.914291,32.042248],[118.91375,32.04179],[118.913559,32.041649],[118.91259,32.040993],[118.912506,32.040947],[118.910622,32.039654],[118.910065,32.039268],[118.909988,32.039207],[118.910713,32.038448],[118.911011,32.038143],[118.911255,32.03793],[118.911308,32.037884],[118.911797,32.037514],[118.912079,32.037323],[118.912468,32.037071],[118.912827,32.036819],[118.91288,32.036785],[118.91288,32.036781],[118.912285,32.036133],[118.912254,32.036106],[118.912018,32.035873],[118.911461,32.035275],[118.910744,32.034523],[118.910706,32.03447],[118.909958,32.033649],[118.908798,32.032444],[118.908409,32.032059],[118.907967,32.03167],[118.907822,32.031578],[118.907173,32.031097],[118.907173,32.03109],[118.907104,32.031036],[118.906738,32.030796],[118.906517,32.03067],[118.906265,32.030529],[118.905777,32.03027],[118.905273,32.030048],[118.904839,32.029873],[118.903732,32.029472],[118.903725,32.029469],[118.903679,32.029549],[118.903358,32.029888],[118.903236,32.030018],[118.902939,32.030319],[118.902695,32.030579],[118.902473,32.030819],[118.902061,32.031284],[118.901611,32.031815],[118.901535,32.031895],[118.901184,32.032341],[118.901176,32.032345],[118.9011,32.03231],[118.90097,32.032257],[118.900719,32.032143],[118.900269,32.031944],[118.900078,32.031845],[118.899582,32.031605],[118.899559,32.031593],[118.899544,32.03159],[118.899117,32.031372],[118.898903,32.031258],[118.898895,32.031254],[118.899239,32.030781],[118.899239,32.030777],[118.898087,32.030224],[118.897919,32.030144],[118.896904,32.029644],[118.896896,32.02964],[118.89695,32.029556],[118.89727,32.02898],[118.898026,32.027599],[118.898026,32.027596],[118.897972,32.027565],[118.896873,32.02692],[118.896187,32.02655],[118.896065,32.02647],[118.895218,32.026012],[118.894577,32.025677],[118.894394,32.025585],[118.894318,32.025528],[118.894203,32.025471],[118.894043,32.025387],[118.893616,32.02515],[118.893181,32.024902],[118.892197,32.024372],[118.892105,32.024326],[118.892097,32.024319],[118.891571,32.025009],[118.891327,32.02533],[118.891273,32.02541],[118.891014,32.025734],[118.890205,32.026745],[118.889465,32.027721],[118.888382,32.029106],[118.887627,32.029934],[118.887703,32.030003],[118.888069,32.030308],[118.888252,32.030487],[118.888817,32.031113],[118.888817,32.031116],[118.888718,32.031258],[118.888596,32.031425],[118.888306,32.031826],[118.886528,32.034477],[118.886284,32.034851],[118.885971,32.035313],[118.885651,32.035744],[118.885506,32.036015],[118.885239,32.036419],[118.885155,32.036613],[118.884514,32.036358],[118.883934,32.036079],[118.883308,32.035789],[118.883217,32.035751],[118.883217,32.035748],[118.883194,32.035786],[118.882927,32.036133],[118.882889,32.036179],[118.882385,32.036858],[118.881599,32.037952],[118.881538,32.037914],[118.88018,32.037128],[118.880035,32.037048],[118.877716,32.035778],[118.877464,32.03569],[118.876892,32.035336],[118.876556,32.03513],[118.875977,32.03479],[118.875259,32.034409],[118.875252,32.034401],[118.875305,32.034328],[118.875343,32.034229],[118.875519,32.033928],[118.876602,32.032135],[118.876602,32.032131],[118.875031,32.031429],[118.874199,32.031055],[118.874184,32.031052]]}";
    JSONObject inputJsonObject = JSON.parseObject(inputPoints);
    JSONArray jsonPoints = inputJsonObject.getJSONArray("points");

    List<Coordinate> coordinates = new ArrayList<Coordinate>();
    for (int i = 0; i < jsonPoints.size(); i++) {
      JSONArray jsonPoint = (JSONArray) jsonPoints.get(i);
      Coordinate coordinate = new Coordinate( Double.valueOf(jsonPoint.get(0).toString()), Double.valueOf(jsonPoint.get(1).toString()));
      coordinates.add(coordinate);
    }

    StringBuilder sb = new StringBuilder();
    sb.append("POLYGON((");
    for(Coordinate coordinate : coordinates) {
      sb.append(coordinate.getOrdinate(0)).append(" ").append(coordinate.getOrdinate(1)).append(",");
    }
    sb.deleteCharAt(sb.length()-1);
    sb.append("))");

    WKTReader reader = new WKTReader();
    Geometry metry = reader.read(sb.toString());
    Geometry oMetry = metry.convexHull();

    System.out.println(oMetry.toText());
  }

}
